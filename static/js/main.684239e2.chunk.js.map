{"version":3,"sources":["modernizr-custom.js","audio.js","stats.js","serviceWorker.js","shaders.js","menu.js","index.js"],"names":["e","n","a","o","i","createElement","arguments","u","createElementNS","call","apply","r","c","l","_version","_config","classPrefix","enableClasses","enableJSClass","usePrefixes","_q","on","this","setTimeout","addTest","push","name","fn","options","addAsyncTest","Modernizr","prototype","p","documentElement","nodeName","toLowerCase","canPlayType","Boolean","ogg","replace","mp3","opus","wav","m4a","getContext","webglextensions","webgl","getSupportedExtensions","t","s","length","hasOwnProperty","aliases","split","join","className","baseVal","RegExp","d","window","document","getMicMediaStream","constraints","audio","videol","navigator","mediaDevices","getUserMedia","console","log","webkitGetUserMedia","Promise","resolve","reject","micSource","mediaStream","context","newAudioContext","source","createMediaStreamSource","stream","fileSource","sourceEl","src","process","appendChild","createMediaElementSource","connect","destination","AudioContext","webkitAudioContext","reqId","makeStats","stats","Stats","showFpsCounter","enabled","body","dom","style","right","left","requestAnimationFrame","loop","update","cancelAnimationFrame","undefined","removeChild","location","hostname","match","Menu","app","el","getElementById","playback","progress","mic","toggle","fullscreen","info","addEventListener","_toggleFullscreen","_toggleMicrophone","_togglePlayback","_toggleControls","_toggleInfo","event","keyCode","key","_toggle","useMic","stopMic","useAudio","value","Math","round","currentTime","duration","fullscreenElement","requestFullscreen","exitFullscreen","serviceWorker","ready","then","registration","unregister","catch","error","message","GlAttractor","numPoints","canvas","setWidth","min","innerHeight","innerWidth","setHeight","width","setMargin","height","margin","gl","antialias","depth","program","compileShaders","useProgram","u_pointSize","getUniformLocation","uniform1f","devicePixelRatio","useVertexBuffer","rootEl","fragmentShaderCode","vertexShaderCode","vertexShader","createShader","VERTEX_SHADER","shaderSource","compileShader","getShaderParameter","COMPILE_STATUS","getShaderInfoLog","fragmentShader","FRAGMENT_SHADER","createProgram","attachShader","linkProgram","getProgramParameter","LINK_STATUS","getProgramInfoLog","array","Float32Array","map","random","vertexBuffer","createBuffer","bindBuffer","ARRAY_BUFFER","bufferData","STATIC_DRAW","a_position","getAttribLocation","vertexAttribPointer","FLOAT","enableVertexAttribArray","b","color","u_a","u_b","u_c","u_d","u_color","drawArrays","POINTS","SoundMapper","energy","features","analyzer","ts","get","_energyBin","_oscillation","_getColor","_getD","flatness","sin","floor","App","points","pow","attractor","file","playbackActive","pause","paused","_makeAnalyzer","state","close","getTracks","forEach","track","stop","play","resume","Meyda","createMeydaAnalyzer","audioContext","bufferSize","windowingFunction","featureExtractors","onload","loadFile","mapper","menu","timestamp","uniforms","getUniforms","setUniforms","draw"],"mappings":"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","file":"static/js/main.684239e2.chunk.js","sourcesContent":["/*! modernizr 3.6.0 (Custom Build) | MIT *\n * https://modernizr.com/download/?-audio-canvas-eventlistener-webgl-webglextensions-setclasses\n * !*/\n\n // eslint-disable-next-line\n!function(e,n,a){function o(e,n){return typeof e===n}function t(){var e,n,a,t,s,i,l;for(var p in c)if(c.hasOwnProperty(p)){if(e=[],n=c[p],n.name&&(e.push(n.name.toLowerCase()),n.options&&n.options.aliases&&n.options.aliases.length))for(a=0;a<n.options.aliases.length;a++)e.push(n.options.aliases[a].toLowerCase());for(t=o(n.fn,\"function\")?n.fn():n.fn,s=0;s<e.length;s++)i=e[s],l=i.split(\".\"),1===l.length?Modernizr[l[0]]=t:(!Modernizr[l[0]]||Modernizr[l[0]]instanceof Boolean||(Modernizr[l[0]]=new Boolean(Modernizr[l[0]])),Modernizr[l[0]][l[1]]=t),r.push((t?\"\":\"no-\")+l.join(\"-\"))}}function s(e){var n=p.className,a=Modernizr._config.classPrefix||\"\";if(u&&(n=n.baseVal),Modernizr._config.enableJSClass){var o=new RegExp(\"(^|\\\\s)\"+a+\"no-js(\\\\s|$)\");n=n.replace(o,\"$1\"+a+\"js$2\")}Modernizr._config.enableClasses&&(n+=\" \"+a+e.join(\" \"+a),u?p.className.baseVal=n:p.className=n)}function i(){return\"function\"!=typeof n.createElement?n.createElement(arguments[0]):u?n.createElementNS.call(n,\"http://www.w3.org/2000/svg\",arguments[0]):n.createElement.apply(n,arguments)}var r=[],c=[],l={_version:\"3.6.0\",_config:{classPrefix:\"\",enableClasses:!0,enableJSClass:!0,usePrefixes:!0},_q:[],on:function(e,n){var a=this;setTimeout(function(){n(a[e])},0)},addTest:function(e,n,a){c.push({name:e,fn:n,options:a})},addAsyncTest:function(e){c.push({name:null,fn:e})}},Modernizr=function(){};Modernizr.prototype=l,Modernizr=new Modernizr,Modernizr.addTest(\"eventlistener\",\"addEventListener\"in e);var p=n.documentElement,u=\"svg\"===p.nodeName.toLowerCase();Modernizr.addTest(\"audio\",function(){var e=i(\"audio\"),n=!1;try{n=!!e.canPlayType,n&&(n=new Boolean(n),n.ogg=e.canPlayType('audio/ogg; codecs=\"vorbis\"').replace(/^no$/,\"\"),n.mp3=e.canPlayType('audio/mpeg; codecs=\"mp3\"').replace(/^no$/,\"\"),n.opus=e.canPlayType('audio/ogg; codecs=\"opus\"')||e.canPlayType('audio/webm; codecs=\"opus\"').replace(/^no$/,\"\"),n.wav=e.canPlayType('audio/wav; codecs=\"1\"').replace(/^no$/,\"\"),n.m4a=(e.canPlayType(\"audio/x-m4a;\")||e.canPlayType(\"audio/aac;\")).replace(/^no$/,\"\"))}catch(a){}return n}),Modernizr.addTest(\"canvas\",function(){var e=i(\"canvas\");return!(!e.getContext||!e.getContext(\"2d\"))}),Modernizr.addTest(\"webgl\",function(){var n=i(\"canvas\"),a=\"probablySupportsContext\"in n?\"probablySupportsContext\":\"supportsContext\";return a in n?n[a](\"webgl\")||n[a](\"experimental-webgl\"):\"WebGLRenderingContext\"in e}),Modernizr.addAsyncTest(function(){if(Modernizr.webglextensions=!1,Modernizr.webgl){var e,n,o;try{e=i(\"canvas\"),n=e.getContext(\"webgl\")||e.getContext(\"experimental-webgl\"),o=n.getSupportedExtensions()}catch(t){return}n!==a&&(Modernizr.webglextensions=new Boolean(!0));for(var s=-1,r=o.length;++s<r;)Modernizr.webglextensions[o[s]]=!0;e=a}}),t(),s(r),delete l.addTest,delete l.addAsyncTest;for(var d=0;d<Modernizr._q.length;d++)Modernizr._q[d]();e.Modernizr=Modernizr}(window,document);\n\nexport default window.Modernizr;\n","async function getMicMediaStream() {\n  const constraints = { audio: true, videol: false };\n  if (navigator.mediaDevices.getUserMedia) {\n    console.log(\"Using navigator.mediaDevices\");\n    return navigator.mediaDevices.getUserMedia(constraints);\n  } else if (navigator.webkitGetUserMedia || navigator.getUserMedia) {\n    navigator.getUserMedia = navigator.getUserMedia || navigator.webkitGetUserMedia;\n    return new Promise((resolve, reject) => {\n      navigator.getUserMedia(constraints, resolve, reject);\n    });\n  }\n}\n\nexport async function micSource() {\n  const mediaStream = await getMicMediaStream();\n  const context = newAudioContext();\n  return { context, source: context.createMediaStreamSource(mediaStream), stream: mediaStream};\n};\n\n\nexport async function fileSource() {\n  const audio = document.createElement('audio');\n  const sourceEl = document.createElement('source');\n  sourceEl.src = process.env.PUBLIC_URL + \"/max-cooper-fragments-of-self-sample.mp3\";\n  audio.appendChild(sourceEl);\n  const context = newAudioContext();\n  const source = context.createMediaElementSource(audio);\n  source.connect(context.destination);\n  return { context, source, audio };\n}\n\nfunction newAudioContext() {\n  const AudioContext = window.AudioContext // Default\n  || window.webkitAudioContext // Safari and old versions of Chrome\n  || false;\n  return new AudioContext();\n}\n","import Stats from \"stats.js\";\n\nfunction makeStats() {\n  // poor man's run once\n  if (makeStats.stats) return makeStats.stats;\n  makeStats.stats = new Stats();\n  return makeStats.stats;\n}\n\nlet reqId;\nexport const showFpsCounter = enabled => {\n  const stats = makeStats();\n  if (enabled && !reqId) {\n    document.body.appendChild(stats.dom);\n    stats.dom.style.right = 0;\n    stats.dom.style.left = null;\n    reqId = requestAnimationFrame(function loop() {\n      stats.update();\n      reqId = requestAnimationFrame(loop);\n    });\n  } else if (!enabled && reqId) {\n    cancelAnimationFrame(reqId);\n    reqId = undefined;\n    document.body.removeChild(stats.dom);\n  }\n};\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' },\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","export const fragmentShaderCode = `\nprecision highp float;\n\nuniform float u_color;\n\nvarying float v_t;\n\nconst float PI = 3.14159265359;\n\nvec3 cubehelix(float x, float y, float z) {\n  float a = y * z * (1.0 - z);\n  float c = cos(x + PI / 2.0);\n  float s = sin(x + PI / 2.0);\n  return vec3(\n    z + a * (1.78277 * s - 0.14861 * c),\n    z - a * (0.29227 * c + 0.90649 * s),\n    z + a * (1.97294 * c)\n  );\n}\n\nvec3 rainbow(float t) {\n  if (t < 0.0 || t > 1.0) t -= floor(t);\n  float ts = abs(t - 0.5);\n  return cubehelix(\n    (360.0 * t - 100.0) / 180.0 * PI,\n    1.5 - 1.5 * ts,\n    u_color - 0.9 * ts\n  );\n}\n\nvoid main() {\n  gl_FragColor = vec4(rainbow(v_t / 4.0 + 0.25), 1.0);\n}\n`;\n\nexport const vertexShaderCode = `\nprecision highp float;\n\nconst float PI = 3.14159265359;\n\nuniform float u_pointSize;\nuniform float u_a;\nuniform float u_b;\nuniform float u_c;\nuniform float u_d;\n\nattribute vec2 a_position;\n\nvarying float v_t;\n\nvoid main() {\nfloat x1, x2 = a_position.x;\nfloat y1, y2 = a_position.y;\nfor (int i = 0; i < 8; i++) {\n  x1 = x2, y1 = y2;\n  x2 = sin(u_a * y1) - cos(u_b * x1);\n  y2 = sin(u_c * x1) - cos(u_d * y1);\n}\nv_t = atan(a_position.y, a_position.x) / PI;\ngl_Position = vec4(x2 / 2.0, y2 / 2.0, 0.0, 1.0);\ngl_PointSize = u_pointSize;\n}\n`;\n","import { showFpsCounter } from \"./stats\";\n\nexport class Menu {\n  constructor(app) {\n    this.app = app;\n    this.el = document.getElementById('menu');\n\n    this.playback = document.getElementById('playback');\n    this.progress = document.getElementById('progress');\n    this.mic = document.getElementById('mic');\n    this.toggle = document.getElementById('toggle-controls');\n    this.fullscreen = document.getElementById('fullscreen');\n    this.info = document.getElementById('info');\n\n    this.fullscreen.addEventListener('click', () => this._toggleFullscreen());\n    this.mic.addEventListener('click', async () => await this._toggleMicrophone());\n    this.playback.addEventListener('click', () => this._togglePlayback());\n    this.toggle.addEventListener('click', () => this._toggleControls());\n    this.info.addEventListener('click', () => this._toggleInfo());\n\n    document.addEventListener('keypress', async (event) => {\n      if (event.keyCode === 104 || event.key === \"h\") {\n        this._toggleControls();\n      } else if (event.keyCode === 103 || event.key === \"f\") {\n        this._toggleFullscreen();\n      } else if (event.keyCode === 109 || event.key === \"m\") {\n        await this._toggleMicrophone();\n      } else if (event.keyCode === 112 || event.key === \"p\") {\n        this._togglePlayback();\n      } else if (event.keyCode === 105 || event.key === \"i\") {\n        this._toggleInfo();\n      }\n    });\n    // prevents FOUC\n    this.el.className = '';\n  }\n\n  async _toggleMicrophone() {\n    const active = this._toggle(this.mic);\n    if (active) {\n      this.progress.className = 'hide';\n      await this.app.useMic();\n    } else {\n      this.app.stopMic();\n    }\n    this.playback.className = 'off';\n  }\n\n  _togglePlayback() {\n    this._toggle(this.playback);\n    this.mic.className = 'off';\n    const audio = this.app.useAudio();\n    this.progress.className = '';\n    // TODO: check if handler is duplicated\n    audio.addEventListener('timeupdate', () => {\n      // console.log(audio.currentTime, audio.duration, audio.currentTime / audio.duration)\n      this.progress.value = Math.round((audio.currentTime / audio.duration) * 100);\n      // this.playback.setAttribute('data-progress', audio.currentTime / audio.duration);\n    });\n  }\n\n  _toggleInfo() {\n    this._toggle(this.info);\n    const info = document.getElementById('info-box');\n    if (info.className === 'hide') {\n      info.className = '';\n    } else {\n      info.className = 'hide';\n    }\n  }\n\n  _toggleControls() {\n    if (this.el.className === 'hide') {\n      showFpsCounter(true);\n      this.el.className = '';\n    } else {\n      showFpsCounter(false);\n      this.el.className = 'hide';\n    }\n  }\n\n  _toggleFullscreen() {\n    const active = this._toggle(this.fullscreen);\n    if (active && !document.fullscreenElement) {\n      document.documentElement.requestFullscreen();\n    } else {\n      if (document.exitFullscreen) {\n        document.exitFullscreen();\n      }\n    }\n  }\n\n  _toggle(el) {\n    if (el.className === 'on') {\n      el.className = 'off';\n    } else {\n      el.className = 'on';\n    }\n    return el.className === 'on';\n  }\n}\n","import Meyda from 'meyda';\nimport Modernizr from './modernizr-custom';\nimport { micSource, fileSource } from './audio';\nimport { showFpsCounter } from \"./stats\";\nimport './index.css';\nimport * as serviceWorker from './serviceWorker';\nimport { fragmentShaderCode, vertexShaderCode } from './shaders';\nimport { Menu } from './menu';\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n\nclass GlAttractor {\n  constructor(numPoints) {\n    this.canvas = document.createElement('canvas');\n    this.setWidth(Math.min(window.innerHeight, window.innerWidth));\n    this.setHeight(this.width);\n    this.setMargin((window.innerHeight - this.height) / 2)\n    this.canvas.style = `width: ${this.width}px; height: ${this.height}px; margin: ${this.margin};`;\n    this.gl = this.canvas.getContext(\"webgl\", {antialias: true, depth: false});\n    this.program = this.compileShaders(fragmentShaderCode, vertexShaderCode);\n    this.gl.useProgram(this.program);\n    const u_pointSize = this.gl.getUniformLocation(this.program, \"u_pointSize\");\n    this.gl.uniform1f(u_pointSize, devicePixelRatio > 1 ? 1.5 : .75);\n\n    this.numPoints = numPoints;\n    this.useVertexBuffer();\n\n    const rootEl = document.getElementById(\"root\");\n    rootEl.style = `width: ${this.width}px; height: ${this.height}px`;\n    rootEl.appendChild(this.canvas);\n  }\n\n  setWidth(width) {\n    this.width = width;\n    this.canvas.width = width * devicePixelRatio;\n    this.canvas.style = this.canvas.style + `width: ${width}px;`;\n  }\n\n  setHeight(height) {\n    this.height = height;\n    this.canvas.height = height * devicePixelRatio;\n    this.canvas.style = this.canvas.style + `height: ${height}px;`;\n  }\n\n  setMargin(margin) {\n    this.margin = margin;\n    this.canvas.style = this.canvas.style + `margin: ${margin} auto;`;\n  }\n\n  compileShaders(fragmentShaderCode, vertexShaderCode) {\n    const gl = this.gl;\n    const vertexShader = gl.createShader(gl.VERTEX_SHADER);\n    gl.shaderSource(vertexShader, vertexShaderCode);\n    gl.compileShader(vertexShader);\n    if (!gl.getShaderParameter(vertexShader, gl.COMPILE_STATUS)) throw gl.getShaderInfoLog(vertexShader);\n\n    const fragmentShader = gl.createShader(gl.FRAGMENT_SHADER);\n    gl.shaderSource(fragmentShader, fragmentShaderCode);\n    gl.compileShader(fragmentShader);\n    if (!gl.getShaderParameter(fragmentShader, gl.COMPILE_STATUS)) throw gl.getShaderInfoLog(fragmentShader);\n\n    const program = gl.createProgram();\n    gl.attachShader(program, vertexShader);\n    gl.attachShader(program, fragmentShader);\n    gl.linkProgram(program);\n    if (!gl.getProgramParameter(program, gl.LINK_STATUS)) throw gl.getProgramInfoLog(program);\n\n    return program;\n  }\n\n  useVertexBuffer() {\n    const gl = this.gl;\n    const array = new Float32Array(this.numPoints * 2).map(() => Math.random() * 2 - 1);\n    const vertexBuffer = gl.createBuffer();\n    gl.bindBuffer(gl.ARRAY_BUFFER, vertexBuffer);\n    gl.bufferData(gl.ARRAY_BUFFER, array, gl.STATIC_DRAW);\n    gl.bindBuffer(gl.ARRAY_BUFFER, vertexBuffer);\n    const a_position = gl.getAttribLocation(this.program, \"a_position\");\n    gl.vertexAttribPointer(a_position, 2, gl.FLOAT, false, 0, 0);\n    gl.enableVertexAttribArray(a_position);\n  }\n\n  setUniforms(a, b, c, d, color) {\n    const u_a = this.gl.getUniformLocation(this.program, \"u_a\")\n    const u_b = this.gl.getUniformLocation(this.program, \"u_b\")\n    const u_c = this.gl.getUniformLocation(this.program, \"u_c\")\n    const u_d = this.gl.getUniformLocation(this.program, \"u_d\")\n    const u_color = this.gl.getUniformLocation(this.program, \"u_color\")\n    this.gl.uniform1f(u_a, a);\n    this.gl.uniform1f(u_b, b);\n    this.gl.uniform1f(u_c, c);\n    this.gl.uniform1f(u_d, d);\n    this.gl.uniform1f(u_color, color);\n  }\n\n  draw() {\n    const gl = this.gl;\n    gl.drawArrays(gl.POINTS, 0, this.numPoints);\n  }\n}\n\nclass SoundMapper {\n  constructor() {\n    this.energy = 0;\n    this.features = {};\n  }\n\n  getUniforms(analyzer, ts) {\n    if (analyzer) {\n      const features = analyzer.get([\"energy\", \"spectralFlatness\"]);\n      if (features) {\n        this.energy += features.energy;\n        this.features = features;\n      } else {\n        this.features = {};\n      }\n    }\n    switch (this._energyBin() % 10) {\n      case 1:\n      case 4:\n      case 7:\n        return [-2.0, this._oscillation(ts)-2.0, -1.2, 2.0, this._getColor(ts)]\n      case 2:\n      case 5:\n        return [-2.0, -2.53, this._oscillation(ts)-1.61, 2.0, this._getColor(ts)]\n      default:\n        return [this._oscillation(ts) - 2.0, -2.0, -1.2, this._getD(), this._getColor(ts)]\n    }\n  }\n\n  _getD() {\n    return (this.features.flatness < .05) ? 2.0 - this.features.energy : 2.0;\n  }\n\n  _getColor(ts) {\n    if (this.features.energy < .5) {\n      return .0;\n    } else if (this.features.energy < 2) {\n      return Math.min(.8, (Math.sin(ts / 8000) + 1) / 2);\n    } else {\n      return .8;\n    }\n  }\n\n  _energyBin() {\n    return Math.floor(this.energy / 100);\n  }\n\n  _oscillation(ts) {\n    return Math.sin(this.energy / 100 + ts / 10000);\n  }\n}\n\nclass App {\n  constructor() {\n    const points = devicePixelRatio > 1 ? Math.pow(2, 20) : Math.pow(2, 19);\n    this.attractor = new GlAttractor(points);\n  }\n\n  async loadFile() {\n    this.file = await fileSource();\n  }\n\n  async useMic() {\n    const {context, source, stream} = await micSource();\n    if (this.playbackActive) {\n      this.playbackActive = false;\n      this.audio.pause();\n      this.paused = true;\n    }\n\n    this.stream = stream;\n    this.context = context;\n    this.analyzer = this._makeAnalyzer(context, source);\n  }\n\n  stopMic() {\n    this.analyzer = null;\n    if (this.context && this.context.state === 'running') {\n      console.log(this.context.state);\n      this.context.close();\n    }\n    if (this.stream) {\n      this.stream.getTracks().forEach(track => track.stop());\n      this.stream = null;\n    }\n  }\n\n  useAudio() {\n    if (this.playbackActive) {\n      if (this.paused) {\n        console.log('play');\n        this.audio.play();\n        this.paused = false;\n      } else {\n        console.log('pause');\n        this.audio.pause();\n        this.paused = true;\n      }\n    } else {\n      this.stopMic();\n      this.audio = this.file.audio;\n      this.context = this.file.context;\n      this.analyzer = this._makeAnalyzer(this.context, this.file.source);\n      this.playbackActive = true;\n      this.paused = false;\n      this.audio.play();\n      if (this.context.state === 'suspended') {\n        this.context.resume();\n        console.log('resume + play');\n      }\n    }\n    return this.audio;\n  }\n\n  _makeAnalyzer(context, source) {\n    return Meyda.createMeydaAnalyzer({\n      audioContext: context,\n      bufferSize: 512,\n      source,\n      windowingFunction: 'blackman',\n      // perceptualSharpness, zcr, rms\n      featureExtractors: [\"energy\", \"spectralFlatness\"],\n    });\n  }\n}\n\nwindow.onload = async function onLoad() {\n  showFpsCounter(true);\n  const app = new App();\n  await app.loadFile();\n  const mapper = new SoundMapper();\n  const menu = new Menu(app);\n  if (!(Modernizr.audio && Modernizr.webgl && Modernizr.canvas)) {\n    document.getElementById(\"warn-support\").className = '';\n    menu._toggleInfo();\n  }\n  requestAnimationFrame(function loop(timestamp) {\n    const uniforms = mapper.getUniforms(app.analyzer, timestamp);\n    app.attractor.setUniforms(...uniforms);\n    app.attractor.draw();\n\n    // document.getElementById(\"meyda-debug\").innerHTML = `${Math.floor(mapper.energy)} ${Math.floor(mapper.features.energy)}`;\n    requestAnimationFrame(loop);\n  });\n};\n"],"sourceRoot":""}