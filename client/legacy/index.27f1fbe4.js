import{_ as t,a as n,b as e,c as a,i as o,s as r,d as i,S as c,e as s,f as u,q as f,g as l,h as d,j as h,k as m,l as g,m as v,n as _,o as x,p as y,r as S,t as b}from"./client.a2243a69.js";function A(t){var a=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var o,r=n(t);if(a){var i=n(this).constructor;o=Reflect.construct(r,arguments,i)}else o=r.apply(this,arguments);return e(this,o)}}var w=y.document;function P(t){var n,e;return{c:function(){n=s(),e=u("div"),this.h()},l:function(t){f('[data-svelte="svelte-oh6yg0"]',w.head).forEach(l),n=d(t),e=h(t,"DIV",{id:!0}),m(e).forEach(l),this.h()},h:function(){w.title="Sapper project template",g(e,"id","attractor")},m:function(t,a){v(t,n,a),v(t,e,a)},p:_,i:_,o:_,d:function(t){t&&l(n),t&&l(e)}}}function M(t){var n=Math.pow(2,20),e="\nprecision highp float;\n\nvarying float v_t;\n\nconst float PI = 3.14159265359;\n\nvec3 cubehelix(float x, float y, float z) {\n\tfloat a = y * z * (1.0 - z);\n\tfloat c = cos(x + PI / 2.0);\n\tfloat s = sin(x + PI / 2.0);\n\treturn vec3(\n\t\tz + a * (1.78277 * s - 0.14861 * c),\n\t\tz - a * (0.29227 * c + 0.90649 * s),\n\t\tz + a * (1.97294 * c)\n\t);\n}\n\nvec3 rainbow(float t) {\n\tif (t < 0.0 || t > 1.0) t -= floor(t);\n\tfloat ts = abs(t - 0.5);\n\treturn cubehelix(\n\t\t(360.0 * t - 100.0) / 180.0 * PI,\n\t\t1.5 - 1.5 * ts,\n\t\t0.8 - 0.9 * ts\n\t);\n}\n\nvoid main() {\n\tgl_FragColor = vec4(rainbow(v_t / 4.0 + 0.25), 1.0);\n}\n",a="\nprecision highp float;\n\nconst float PI = 3.14159265359;\n\nuniform float u_a;\nuniform float u_b;\nuniform float u_c;\nuniform float u_d;\n\nattribute vec2 a_position;\n\nvarying float v_t;\n\nvoid main() {\n  float x1, x2 = a_position.x;\n  float y1, y2 = a_position.y;\n  for (int i = 0; i < 8; i++) {\n    x1 = x2, y1 = y2;\n    x2 = sin(u_a * y1) - cos(u_b * x1);\n    y2 = sin(u_c * x1) - cos(u_d * y1);\n  }\n  v_t = atan(a_position.y, a_position.x) / PI;\n  gl_Position = vec4(x2 / 2.0, y2 / 2.0, 0.0, 1.0);\n  gl_PointSize = 1.5;\n}\n";return x(S(b.mark((function t(){var o,r,i,c,s,u,f,l,d,h,m,g,v,_,x,y;return b.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return y=function(t){void 0===_&&(_=t);var n=t-_,e=x.get(["rms"]),a=e?e.rms:0,o=Math.floor(1e4*a),r=Math.min(Math.max(Math.sin(n)*o,-66),66);console.log(r),document.getElementById("attractor").style.transform="translateX("+r+"px)";var i=-2+Math.sin(t/8e3);c.setUniform("u_a",i),c.setUniform("u_b",m),c.setUniform("u_c",g),c.setUniform("u_d",v),window.requestAnimationFrame(y)},t.next=3,import("./GlslCanvas.es.840a5b85.js");case 3:return o=t.sent.default,t.next=6,import("./meyda.min.8549eab8.js").then((function(t){return t.m}));case 6:r=t.sent.default,console.log(o),console.log("meyda",r),980,980,i=document.createElement("canvas"),c=new o(i),i.width=980*devicePixelRatio,i.height=980*devicePixelRatio,i.style="width: ".concat(980,"px; height: ").concat(980,"px;border:1px solid black;"),(s=i.value=i.getContext("webgl",{antialias:!1,depth:!1})).getExtension("OES_texture_float"),s.viewport(0,0,s.width,s.height),u=function(){var t=s.createShader(s.FRAGMENT_SHADER);if(s.shaderSource(t,e),s.compileShader(t),!s.getShaderParameter(t,s.COMPILE_STATUS))throw s.getShaderInfoLog(t);return t}(),f=function(){var t=s.createShader(s.VERTEX_SHADER);if(s.shaderSource(t,a),s.compileShader(t),!s.getShaderParameter(t,s.COMPILE_STATUS))throw s.getShaderInfoLog(t);return t}(),l=function(){var t=s.createProgram();if(s.attachShader(t,f),s.attachShader(t,u),s.linkProgram(t),!s.getProgramParameter(t,s.LINK_STATUS))throw s.getProgramInfoLog(t);return t}(),S=void 0,b=void 0,S=new Float32Array(2*n).map((function(){return 2*Math.random()-1})),b=s.createBuffer(),s.bindBuffer(s.ARRAY_BUFFER,b),s.bufferData(s.ARRAY_BUFFER,S,s.STATIC_DRAW),d=b,s.useProgram(l),s.bindBuffer(s.ARRAY_BUFFER,d),h=s.getAttribLocation(l,"a_position"),s.vertexAttribPointer(h,2,s.FLOAT,!1,0,0),s.enableVertexAttribArray(h),-2.5,m=-2,g=-1.2,v=2,document.getElementById("attractor").appendChild(i),c.setUniform("u_a",-2.5),c.setUniform("u_b",m),c.setUniform("u_c",g),c.setUniform("u_d",v),c.load(e,a),x={get:function(){}},window.requestAnimationFrame(y),function(){console.log("Microphone?");var t=function(t){throw t};try{navigator.getUserMedia=navigator.webkitGetUserMedia||navigator.getUserMedia||navigator.mediaDevices.getUserMedia;var n=function(t){var n=new AudioContext;x=r.createMeydaAnalyzer({audioContext:n,bufferSize:512,source:n.createMediaStreamSource(t),windowingFunction:"blackman",featureExtractors:["rms"]}),console.log("User allowed microphone access."),console.log("Initializing AudioNode from MediaStream"),console.log("Setting Meyda Source to Microphone"),console.groupEnd()};console.log("Asking for permission..."),navigator.getUserMedia({video:!1,audio:!0},n,t)&&(p.then(n),p.catch(t))}catch(n){t()}}();case 41:case"end":return t.stop()}var S,b}),t)})))),[]}var R=function(n){t(s,c);var e=A(s);function s(t){var n;return a(this,s),n=e.call(this),o(i(n),t,M,P,r,{}),n}return s}();export default R;
